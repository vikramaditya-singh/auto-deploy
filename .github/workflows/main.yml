name: Deploy AWS

on:
  push:
    branches:
    - master

jobs:
  deploy-lambda:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@master
      - name: build
        uses: thedoctor0/zip-release@main
        with:
          type: 'zip'
          filename: 'lambda-a.zip'
          exclusions: '*.git* *.github'
      # - name: create-lambda-function
      #   run: |
          # aws lambda create-function --function-name=lambda-b --runtime='python3.8' --handler=file.func_name --role='arn:aws:iam::858701282395:role/lamdbaS3AccessRole' --timeout=60 --zip-file=fileb://lambda-a.zip

        - name: deploy lambda-b
          run: |
            aws lambda update-function-code --function-name=lambda-a --zip-file=fileb://lambda-a.zip
        env:
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          AWS_DEFAULT_REGION: 'us-west-2'


# jobs:
#   deploy-lambda:
#     runs-on: ubuntu-latest
#     steps:
#       - uses: actions/checkout@master
#       - name: build
#         uses: thedoctor0/zip-release@main
#         with:
#           type: 'zip'
#           filename: 'lambda-a.zip'
#           exclusions: '*.git* *.github'
#       - name: deply
#         run: |
#           aws lambda update-function-code --function-name=lambda-a --zip-file=fileb://lambda-a.zip

#         env:
#           AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
#           AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
#           AWS_DEFAULT_REGION: 'us-west-2'

